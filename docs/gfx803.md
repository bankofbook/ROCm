
# so many gfx803 issues on ROCm-3.7+

Date: 2020-11-21

|software       |description   |
|---------------|--------------|
|OS             |Ubuntu-20.04.1|
|Python         |3.8.6         |
|Tensorflow-rocm|2.3.2         |

|hardware|description                         |
|--------|------------------------------------|
|CPU     |Xeon 2620v3                         |
|GPU     |RX580 8G (Polaris10) CHIP ID: 0x67df|

---

## ROCm-3.9 crash with gfx803

### Description

If you installed ROCm-3.9 with gfx803, you will crash on very beginning of running tensorflow or pytorch.
Error info as follows:

```
work@0b7758c3094d:~/test/examples/mnist$ python3 main.py
/src/external/hip-on-vdi/rocclr/hip_code_object.cpp:120: guarantee(false && "hipErrorNoBinaryForGpu: Coudn't find binary for current devices!")
Aborted (core dumped)
```

### Reason of problem

rocSPARSE placed CACHED AMDGPU_TARGETS after include Dependencies.cmake, so it is always skipped.
The AMDGPU_TARGETS from include Dependencies.cmake is "gfx900;gfx906;gfx908", not including gfx803.
So rocSPARSE didnot compile gfx803 binary image.

### Issue (closed)

<https://github.com/RadeonOpenCompute/ROCm/issues/1269>

### Pull request (merged)

<https://github.com/ROCmSoftwarePlatform/rocSPARSE/pull/213>

### Manual solution

1. `git clone https://github.com/ROCmSoftwarePlatform/rocSPARSE`
2. `cd rocSPARSE`
3. `git checkout rocm-3.9.0`
4. `bash install.sh -di`

---

